<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <link rel="stylesheet" src="css/styles.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>

    <style>
        body {
            color: white;
            background-color: #95a2ab;
        }
        /* Estilos generales para el tbody */
        tbody, thead {
            font-size: 20px;  /* Cambia el tamaño de la letra */
            color: #ffffff;   /* Cambia el color de la letra */
            background-color: #333333;  /* Fondo gris oscuro para el tbody */
            /**line-height: 1.8;  /* Aumenta el espaciado entre líneas */
            text-align: center;  /* Centra el texto */
        }

        /* Estilo para las filas pares */
        tbody tr:nth-child(even) {
            background-color: #393939;  /* Fondo más claro para filas pares */
        }

        /* Estilo para las filas impares */
        tbody tr:nth-child(odd) {
            background-color: #333333;  /* Fondo más oscuro para filas impares */
        }

        table {
            box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 4px, rgba(0, 0, 0, 0.3) 0px 7px 13px -3px, rgba(0, 0, 0, 0.2) 0px -3px 0px inset;
            /* box-shadow: 0px 0px 24px 0px #fbefcc;  */
        }

        th [contenteditable="true"] {
            background-color: #343430; /* Color de fondo para indicar que es editable */
            color: white;
        }

        #profit {
            border: 2px solid #22aa32;
        }

        #loss {
            border: 2px solid #aa4b22;
        }

        .binance {
            box-shadow: 5px 5px 12px 0px #000000 inset;
            background-color:#ffcc00;
            color: #3b3a30;
            font-size: 30px;
            font-weight: 900;
        }

        .bitget {
            box-shadow: 5px 5px 12px 0px #000000 inset;
            background-color:#00ccff;
            color: #3b3a30;
            font-size: 30px;
            font-weight: 900;
        }

        .quantfury {
            box-shadow: 5px 5px 12px 0px #000000 inset;
            background-color:#4fa190;
            color: #3b3a30;
            font-size: 30px;
            font-weight: 900;
        }

        .btc_price {
            /* box-shadow: 5px 5px 12px 0px #808080 inset; */
            background-color:#181a1c;
            color: #29caf6;
            font-size: 30px;
            font-weight: 900;
        }

    </style>

</head>
<body>

    <nav class="navbar navbar-expand-lg bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand" style="color:white;" href="#">Dashboard</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNavDropdown">
                <ul class="navbar-nav">
                    <li class="nav-item">
                    <a class="nav-link active" style="color:white;" aria-current="page" href="../panel">Trading Panel</a>
                    </li>
                    <li class="nav-item">
                    <a class="nav-link" style="color:white;" href="dashboard_holdings">Holdings</a>
                    </li>
                </ul>
            </div>
            <div class="topnav-centered">
                <marquee behavior="slide" direction="right" scrollamount="5">Have <strong>control</strong> over a high risk and you'll get a high reward! </marquee>
            </div>
        </div>
    </nav>

    <div class="container-fluid mt-4">
        <div class="row">
            <div class="col-md-6">
                <table class="table table-dark table-md table-hover">
                    <thead>
                        <tr align="center">
                            <th colspan="2">BTC Current Price</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr align="center">
                            <td id="btc_price" class="btc_price"></td>
                            <td id="btc_price_q" class="btc_price"></td>
                        </tr>
                    </tbody>
                </table>

                <table class="table table-dark table-md table-hover">
                    <thead>
                        <tr align="center">
                            <th>PnL</th>
                            <th>Volumen</th>
                            <th>Margen</th>
                            <th>% Margen</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr align="center">
                            <td id="pnl_total" style="font-size: 30px"></td>
                            <td id="vol_total" style="font-size: 30px"></td>
                            <td id="margen_total" style="font-size: 30px"></td>
                            <td id="percMargen_total" style="font-size: 30px">
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="col-md-6">
                <table class="table table-dark table-sm table-hover">
                    <thead>
                        <tr align="center">
                            <th></th>
                            <th>Binance</th>
                            <th>Bitget</th>
                            <th>Quantfury</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr align="center">
                            <td>Balance</td>
                            <td class="binance">$850.00</td>
                            <td class="bitget">$1033.00</td>
                            <td class="quantfury">$10,000.00</td>
                        </tr>
                        <tr align="center">
                            <td>Margen</td>
                            <td class="binance" id="margen_binance"></td>
                            <td class="bitget" id="margen_bitget"></td>
                            <td class="quantfury" id="margen_quantfury"></td>
                        </tr>
                        <tr align="center">
                            <td>PnL $</td>
                            <td id="binance" class="binance"></td>
                            <td id="bitget" class="bitget"></td>
                            <td id="quantfury" class="quantfury"></td>
                        </tr>
                        <tr align="center">
                            <td>PnL Q</td>
                            <td id="binance_q" class="binance"></td>
                            <td id="bitget_q" class="bitget"></td>
                            <td id="quantfury_q" class="quantfury"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="container-fluid mt-4">
        <table class="table table-sm table-dark table-hover">
            <thead>
                <tr align="center">
                    <th>#</th>
                    <th>Moneda</th>
                    <th>PnL</th>
                    <th>P. Actual</th>
                    <th>Entrada</th>
                    <th>Distancia</th>
                    <th>X</th>
                    <th>Volumen</th>
                    <th>Margen</th>
                    <!--th>* Profit</th>
                    <th>* Loss</th -->
                    <th contenteditable="true" id="profit">0</th>
                    <th contenteditable="true" id="loss">0</th>
                </tr>
            </thead>
            <tbody id="orders_table"></tbody>
        </table>
    </div>

</body>

<script>
    // Función para recalcular los valores en las columnas "10%" y "20%" en base al porcentaje editable
    function recalculatePercentages() {
        let profit_ = parseFloat($('#profit').text().replace('%', '')) / 100 || 10; // 10% por defecto
        let loss_ = parseFloat($('#loss').text().replace('%', '')) / 100 || -10; // 20% por defecto

        $('#orders_table tr').each(function() {
            let pEntrada = parseFloat($(this).find('.volumen').text().replace(/<[^>]+>/g, '').trim()); // Limpiar el valor
            if (!isNaN(pEntrada)) {
                $(this).find('.calc-profit').text((pEntrada * profit_).toFixed(4)); // Calcular basado en el porcentaje del encabezado
                $(this).find('.calc-loss').text((pEntrada * loss_).toFixed(4));
            }
        });
    }

    $(document).ready(function() {
        // Recalcula porcentajes cuando se edita cualquier encabezado
        $('#profit, #loss').on('input', function() {
            recalculatePercentages(); // Llama a la función para recalcular las columnas
        });

        // Ejecuta la función de cálculo al cargar la página
        recalculatePercentages();
    });
</script>

<script src="js/actions_dashboard.js"></script>
</html>
